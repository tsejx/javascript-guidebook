<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico" />
    <link rel="stylesheet" href="/javascript-guidebook/umi.d5b66b8e.css" />
    <script>
      window.routerBase = "/javascript-guidebook/";
    </script>
    <script>
      //! umi version: 3.5.20
    </script>
    <script>
      !(function () {
        var e = localStorage.getItem("dumi:prefers-color"),
          t = window.matchMedia("(prefers-color-scheme: dark)").matches,
          r = ["light", "dark", "auto"];
        document.documentElement.setAttribute(
          "data-prefers-color",
          e === r[2] ? (t ? r[1] : r[0]) : r.indexOf(e) > -1 ? e : r[0]
        );
      })();
    </script>
    <title>DNS 域名解析系统 - JavaScript Guidebook</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/computer-networks/computer-network-architecture/dns" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/javascript-guidebook-favicon.png&#x27;)" href="/javascript-guidebook//">JavaScript Guidebook</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span><a href="/javascript-guidebook//basic-concept">基本语法</a></span><span><a href="/javascript-guidebook//standard-built-in-objects">内置对象</a></span><span><a href="/javascript-guidebook//core-modules">核心模块</a></span><span><a href="/javascript-guidebook//object-oriented-programming">OOP</a></span><span><a href="/javascript-guidebook//browser-object-model">BOM</a></span><span><a href="/javascript-guidebook//document-object-model">DOM</a></span><span><a aria-current="page" class="active" href="/javascript-guidebook//computer-networks">计算机网络</a></span><span><a href="/javascript-guidebook//design-patterns">设计模式</a></span><span><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/javascript-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span><div class="__dumi-default-navbar-tool"><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "></div></div></div></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/javascript-guidebook-favicon.png&#x27;)" href="/javascript-guidebook//"></a><h1>JavaScript Guidebook</h1><p>JavaScript 完全知识体系</p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a href="/javascript-guidebook//basic-concept">基本语法</a></li><li><a href="/javascript-guidebook//standard-built-in-objects">内置对象</a></li><li><a href="/javascript-guidebook//core-modules">核心模块</a></li><li><a href="/javascript-guidebook//object-oriented-programming">OOP</a></li><li><a href="/javascript-guidebook//browser-object-model">BOM</a></li><li><a href="/javascript-guidebook//document-object-model">DOM</a></li><li><a aria-current="page" class="active" href="/javascript-guidebook//computer-networks">计算机网络</a></li><li><a href="/javascript-guidebook//design-patterns">设计模式</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/javascript-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "><button title="Dark theme" class="__dumi-default-dark-moon "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3854" width="22" height="22"><path d="M991.816611 674.909091a69.166545 69.166545 0 0 0-51.665455-23.272727 70.795636 70.795636 0 0 0-27.438545 5.585454A415.674182 415.674182 0 0 1 754.993338 698.181818c-209.594182 0-393.472-184.785455-393.472-395.636363 0-52.363636 38.539636-119.621818 69.515637-173.614546 4.887273-8.610909 9.634909-16.756364 14.103272-24.901818A69.818182 69.818182 0 0 0 384.631156 0a70.842182 70.842182 0 0 0-27.438545 5.585455C161.678429 90.298182 14.362065 307.898182 14.362065 512c0 282.298182 238.824727 512 532.38691 512a522.286545 522.286545 0 0 0 453.957818-268.334545A69.818182 69.818182 0 0 0 991.816611 674.909091zM546.679156 954.181818c-248.785455 0-462.941091-192-462.941091-442.181818 0-186.647273 140.637091-372.829091 300.939637-442.181818-36.817455 65.629091-92.578909 151.970909-92.578909 232.727273 0 250.181818 214.109091 465.454545 462.917818 465.454545a488.331636 488.331636 0 0 0 185.181091-46.545455 453.003636 453.003636 0 0 1-393.565091 232.727273z m103.656728-669.323636l-14.266182 83.781818a34.909091 34.909091 0 0 0 50.362182 36.770909l74.775272-39.563636 74.752 39.563636a36.142545 36.142545 0 0 0 16.174546 3.956364 34.909091 34.909091 0 0 0 34.210909-40.727273l-14.289455-83.781818 60.509091-59.345455a35.025455 35.025455 0 0 0-19.223272-59.578182l-83.61891-12.101818-37.376-76.101818a34.56 34.56 0 0 0-62.254545 0l-37.376 76.101818-83.618909 12.101818a34.909091 34.909091 0 0 0-19.246546 59.578182z m70.423272-64.698182a34.280727 34.280727 0 0 0 26.135273-19.083636l14.312727-29.090909 14.336 29.090909a34.257455 34.257455 0 0 0 26.135273 19.083636l32.046546 4.887273-23.272728 22.574545a35.234909 35.234909 0 0 0-10.007272 30.952727l5.46909 32.116364-28.625454-15.127273a34.490182 34.490182 0 0 0-32.302546 0l-28.695272 15.127273 5.469091-32.116364a35.141818 35.141818 0 0 0-9.984-30.952727l-23.272728-22.574545z" p-id="3855"></path></svg></button><button title="Light theme" class="__dumi-default-dark-sun "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4026" width="22" height="22"><path d="M915.2 476.16h-43.968c-24.704 0-44.736 16-44.736 35.84s20.032 35.904 44.736 35.904H915.2c24.768 0 44.8-16.064 44.8-35.904s-20.032-35.84-44.8-35.84zM512 265.6c-136.704 0-246.464 109.824-246.464 246.4 0 136.704 109.76 246.464 246.464 246.464S758.4 648.704 758.4 512c0-136.576-109.696-246.4-246.4-246.4z m0 425.6c-99.008 0-179.2-80.128-179.2-179.2 0-98.944 80.192-179.2 179.2-179.2S691.2 413.056 691.2 512c0 99.072-80.192 179.2-179.2 179.2zM197.44 512c0-19.84-19.136-35.84-43.904-35.84H108.8c-24.768 0-44.8 16-44.8 35.84s20.032 35.904 44.8 35.904h44.736c24.768 0 43.904-16.064 43.904-35.904zM512 198.464c19.776 0 35.84-20.032 35.84-44.8v-44.8C547.84 84.032 531.84 64 512 64s-35.904 20.032-35.904 44.8v44.8c0 24.768 16.128 44.864 35.904 44.864z m0 627.136c-19.776 0-35.904 20.032-35.904 44.8v44.736C476.096 940.032 492.16 960 512 960s35.84-20.032 35.84-44.8v-44.736c0-24.768-16.064-44.864-35.84-44.864z m329.92-592.832c17.472-17.536 20.288-43.072 6.4-57.024-14.016-14.016-39.488-11.2-57.024 6.336-4.736 4.864-26.496 26.496-31.36 31.36-17.472 17.472-20.288 43.008-6.336 57.024 13.952 14.016 39.488 11.2 57.024-6.336 4.8-4.864 26.496-26.56 31.296-31.36zM213.376 759.936c-4.864 4.8-26.56 26.624-31.36 31.36-17.472 17.472-20.288 42.944-6.4 56.96 14.016 13.952 39.552 11.2 57.024-6.336 4.8-4.736 26.56-26.496 31.36-31.36 17.472-17.472 20.288-43.008 6.336-56.96-14.016-13.952-39.552-11.072-56.96 6.336z m19.328-577.92c-17.536-17.536-43.008-20.352-57.024-6.336-14.08 14.016-11.136 39.488 6.336 57.024 4.864 4.864 26.496 26.56 31.36 31.424 17.536 17.408 43.008 20.288 56.96 6.336 14.016-14.016 11.264-39.488-6.336-57.024-4.736-4.864-26.496-26.56-31.296-31.424z m527.168 628.608c4.864 4.864 26.624 26.624 31.36 31.424 17.536 17.408 43.072 20.224 57.088 6.336 13.952-14.016 11.072-39.552-6.4-57.024-4.864-4.8-26.56-26.496-31.36-31.36-17.472-17.408-43.072-20.288-57.024-6.336-13.952 14.016-11.008 39.488 6.336 56.96z" p-id="4027"></path></svg></button><button title="Default to system" class="__dumi-default-dark-auto "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11002" width="22" height="22"><path d="M127.658667 492.885333c0-51.882667 10.24-101.717333 30.378666-149.162666s47.786667-88.064 81.92-122.538667 75.093333-61.781333 122.538667-81.92 96.938667-30.378667 149.162667-30.378667 101.717333 10.24 149.162666 30.378667 88.405333 47.786667 122.88 81.92 61.781333 75.093333 81.92 122.538667 30.378667 96.938667 30.378667 149.162666-10.24 101.717333-30.378667 149.162667-47.786667 88.405333-81.92 122.88-75.093333 61.781333-122.88 81.92-97.28 30.378667-149.162666 30.378667-101.717333-10.24-149.162667-30.378667-88.064-47.786667-122.538667-81.92-61.781333-75.093333-81.92-122.88-30.378667-96.938667-30.378666-149.162667z m329.045333 0c0 130.048 13.994667 244.394667 41.984 343.381334h12.970667c46.762667 0 91.136-9.216 133.461333-27.306667s78.848-42.666667 109.568-73.386667 54.954667-67.242667 73.386667-109.568 27.306667-86.698667 27.306666-133.461333c0-46.421333-9.216-90.794667-27.306666-133.12s-42.666667-78.848-73.386667-109.568-67.242667-54.954667-109.568-73.386667-86.698667-27.306667-133.461333-27.306666h-11.605334c-28.672 123.562667-43.349333 237.909333-43.349333 343.722666z" p-id="11003"></path></svg></button></div></div></div><ul class="__dumi-default-menu-list"><li><a href="/javascript-guidebook//computer-networks">计算机网络</a></li><li><a target="_blank" rel="noopener noreferrer">计算机网络体系</a><ul><li><a href="/javascript-guidebook//computer-networks/computer-network-architecture/computer-networks"><span>计算机网络体系</span></a></li><li><a href="/javascript-guidebook//computer-networks/computer-network-architecture/transport-layer-protocol"><span>传输层协议</span></a></li><li><a href="/javascript-guidebook//computer-networks/computer-network-architecture/network-layer-and-data-link-layer-protocol"><span>网络层与数据链路层协议</span></a></li><li><a aria-current="page" class="active" href="/javascript-guidebook//computer-networks/computer-network-architecture/dns"><span>DNS 域名解析系统</span></a></li><li><a href="/javascript-guidebook//computer-networks/computer-network-architecture/cdn"><span>CDN 内容分发网络</span></a></li></ul></li><li><a target="_blank" rel="noopener noreferrer">HTTP</a><ul><li><a href="/javascript-guidebook//computer-networks/http/http"><span>HTTP</span></a></li><li><a href="/javascript-guidebook//computer-networks/http/http-resource-and-uris"><span>HTTP 资源标识</span></a></li><li><a href="/javascript-guidebook//computer-networks/http/http-message"><span>HTTP 报文格式</span></a></li><li><a href="/javascript-guidebook//computer-networks/http/http-headers"><span>HTTP 首部字段</span></a></li><li><a href="/javascript-guidebook//computer-networks/http/http-status-code"><span>HTTP 状态码</span></a></li><li><a href="/javascript-guidebook//computer-networks/http/http-connection"><span>HTTP 连接</span></a></li><li><a href="/javascript-guidebook//computer-networks/http/http-content-negotiation"><span>HTTP 内容协商</span></a></li><li><a href="/javascript-guidebook//computer-networks/http/cross-origin-resource-sharing"><span>HTTP CORS 跨域资源共享</span></a></li><li><a href="/javascript-guidebook//computer-networks/http/content-security-policy"><span>HTTP CSP 内容安全策略</span></a></li><li><a href="/javascript-guidebook//computer-networks/http/https"><span>HTTPS</span></a></li><li><a href="/javascript-guidebook//computer-networks/http/http2"><span>HTTP2</span></a></li><li><a href="/javascript-guidebook//computer-networks/http/http3"><span>HTTP3</span></a></li></ul></li><li><a target="_blank" rel="noopener noreferrer">Web 安全</a><ul><li><a href="/javascript-guidebook//computer-networks/web-security/same-origin-policy"><span>同源策略</span></a></li><li><a href="/javascript-guidebook//computer-networks/web-security/xss"><span>XSS 跨站脚本攻击</span></a></li><li><a href="/javascript-guidebook//computer-networks/web-security/csrf"><span>CSRF 跨站请求伪造攻击</span></a></li><li><a href="/javascript-guidebook//computer-networks/web-security/ddos"><span>DDoS 攻击</span></a></li><li><a href="/javascript-guidebook//computer-networks/web-security/sql-injection"><span>SQL 注入攻击</span></a></li><li><a href="/javascript-guidebook//computer-networks/web-security/hijacking"><span>流量劫持</span></a></li></ul></li><li><a href="/javascript-guidebook//computer-networks/computer-network-architecture">计算机网络体系</a><ul><li><a href="/javascript-guidebook//computer-networks/computer-network-architecture/hls"><span>HLS 流媒体网络传输协议</span></a></li></ul></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="域名的分层结构" data-depth="2"><a href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#域名的分层结构"><span>域名的分层结构</span></a></li><li title="查询类型" data-depth="2"><a href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#查询类型"><span>查询类型</span></a></li><li title="递归查询" data-depth="3"><a href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#递归查询"><span>递归查询</span></a></li><li title="迭代查询" data-depth="3"><a href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#迭代查询"><span>迭代查询</span></a></li><li title="分层结构" data-depth="2"><a href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#分层结构"><span>分层结构</span></a></li><li title="记录类型" data-depth="2"><a href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#记录类型"><span>记录类型</span></a></li><li title="解析过程" data-depth="2"><a href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#解析过程"><span>解析过程</span></a></li><li title="排查与优化" data-depth="2"><a href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#排查与优化"><span>排查与优化</span></a></li><li title="常见问题" data-depth="3"><a href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#常见问题"><span>常见问题</span></a></li><li title="故障排查顺序" data-depth="3"><a href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#故障排查顺序"><span>故障排查顺序</span></a></li><li title="常见优化技术" data-depth="3"><a href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#常见优化技术"><span>常见优化技术</span></a></li><li title="常见优化方法" data-depth="3"><a href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#常见优化方法"><span>常见优化方法</span></a></li><li title="DNS 污染解决方案" data-depth="3"><a href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#dns-污染解决方案"><span>DNS 污染解决方案</span></a></li><li title="DNS 术语" data-depth="2"><a href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#dns-术语"><span>DNS 术语</span></a></li><li title="常用 DNS" data-depth="2"><a href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#常用-dns"><span>常用 DNS</span></a></li><li title="参考资料" data-depth="2"><a href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#参考资料"><span>参考资料</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="dns-域名解析系统"><a aria-hidden="true" tabindex="-1" href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#dns-域名解析系统"><span class="icon icon-link"></span></a>DNS 域名解析系统</h1><p><strong>DNS 域名解析系统（Domain Name System）</strong> 是进行域名（domain name）和与之相对应的 IP 地址（IP address）转换的服务器。DNS 中保存了一张域名（domain name）和与之相对应的 IP 地址（IP address）的表，以解析消息的域名。</p><p>使用 IP 地址而非使用域名进行通信的原因：</p><ul><li>IP 地址是固定长度，IPv4 是 32 位，IPv6 是 128 位，而域名是变长的，不便于计算机处理</li><li>IP 地址对于用户来说不方便记忆，但域名便于用户使用</li></ul><p>简单来说就是 IP 面向主机，域名面向用户。</p><h2 id="域名的分层结构"><a aria-hidden="true" tabindex="-1" href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#域名的分层结构"><span class="icon icon-link"></span></a>域名的分层结构</h2><p>由于因特网的用户数量较多，所以因特网在命名时采用的是层次树状结构的命名方法。任何一个连接在因特网上的主机或路由器，都有一个唯一的层次结构的名字，即域名（domain name）。这里，<strong>域</strong>（domain）是名字空间中一个可被管理的划分。从语法上讲，每一个域名都是有标号（label）序列组成，而各标号之间用点（<code>.</code>）隔开。域名可以划分为各个子域，子域还可以继续划分为子域的子域，这样就形成了顶级域、主域名、子域名等。</p><p><strong>域名系统必须要保持唯一性。</strong></p><p>特点：</p><ol><li>每个域名都是一个标号序列，用字母（大小写等价）、数字（0-9）和连接符（-）组成</li><li>标号序列总长度不能超过 255 个字符，它由各标点之间用 <code>.</code> 分割成一个个的标号</li><li>每个标号应该在 63 个字符之内，每个标号都可以堪称一个层次的域名</li><li>级别最低的域名写在左边，级别最高的域名写在右边</li></ol><p>域名服务是基于 UDP 实现的，服务器的端口号为 <code>53</code>。</p><p>以 <code>www.example.google.com</code> 为例：</p><ul><li><code>.com</code>：是顶级域名</li><li><code>google.com</code>：是主域名（也可称托管一级域名），主要指企业名</li><li><code>example.google.com</code>：是子域名（也可称为托管二级域名）</li><li><code>www.example.google.com</code>：是子域名的子域（也可称为托管三级域名）</li></ul><p>域名可以划分为各个子域，子域还可以继续划分为子域的子域，这样就形成了顶级域、二级域、三级域等。</p><div class="__dumi-default-table"><div class="__dumi-default-table-content"><table><thead><tr><th align="left">顶级域名</th><th align="left">标识</th></tr></thead><tbody><tr><td align="left">国家顶级域名</td><td align="left">中国 <code>cn</code>；美国 <code>us</code>；英国 <code>uk</code></td></tr><tr><td align="left">通用顶级域名</td><td align="left">公司企业 <code>com</code>；教育机构 <code>edu</code>；政府部门 <code>gov</code>；国际组织 <code>int</code>；军事部门 <code>mil</code>；网络 <code>net</code>；非盈利组织 <code>org</code></td></tr><tr><td align="left">反向域名</td><td align="left">Arpa 用于 PTR 查询（IP 地址转换为域名）</td></tr></tbody></table></div></div><h2 id="查询类型"><a aria-hidden="true" tabindex="-1" href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#查询类型"><span class="icon icon-link"></span></a>查询类型</h2><h3 id="递归查询"><a aria-hidden="true" tabindex="-1" href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#递归查询"><span class="icon icon-link"></span></a>递归查询</h3><p>递归查询（Recursive）是一种 DNS 服务器的查询模式，在该模式下 DNS 服务器接收到客户机请求，必须使用一个准确的查询结果回复客户机。如果 DNS 服务器本地没有存储查询 DNS 信息，那么该服务器会询问其他服务器，并将返回的查询结果提交给客户机。所以，一般情况下服务器跟内网 DNS 或直接 DNS 之间都采用递归查询。</p><h3 id="迭代查询"><a aria-hidden="true" tabindex="-1" href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#迭代查询"><span class="icon icon-link"></span></a>迭代查询</h3><p>DNS 服务器另外一种查询方式为迭代查询，DNS 服务器会向客户机提供其他能够解析查询请求的 DNS 服务器地址，当客户机发送查询请求时，DNS 服务器并不直接回复查询结果，而是告诉客户机另一台 DNS 服务器地址，客户机再向这台 DNS 服务器提交请求，依次循环直到返回查询的结果。所以一般内网 DNS 和外网 DNS 之间的都采用迭代查询。</p><h2 id="分层结构"><a aria-hidden="true" tabindex="-1" href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#分层结构"><span class="icon icon-link"></span></a>分层结构</h2><p>域名是分层结构，域名 DNS 服务器也是对应的层级结构。有了域名结构，还需要有域名 DNS 服务器去解析域名，且是需要由遍及全世界的域名 DNS 服务器去解析，域名 DNS 服务器实际上就是装有域名系统的主机。域名解析过程涉及 4 个 DNS 服务器，分别如下：</p><div class="__dumi-default-table"><div class="__dumi-default-table-content"><table><thead><tr><th align="left">分类</th><th align="left">作用</th></tr></thead><tbody><tr><td align="left">根 DNS 服务器</td><td align="left">Root NameServer，本地域名服务器在本地查询不到解析结果时，则第一步会向它进行查询，并获取顶级域名服务器的 IP 地址。</td></tr><tr><td align="left">顶级域名服务器</td><td align="left">TLD（Top-level） NameServer。负责管理在该顶级域名服务器下注册的二级域名，例如 <code>www.example.com</code>、<code>.com</code> 则是顶级域名服务器，在向它查询时，可以返回二级域名 <code>example.com</code> 所在的权威域名服务器地址</td></tr><tr><td align="left">权威域名服务器</td><td align="left">Authoritative NameServer。在特定区域内具有唯一性，负责维护该区域内的域名与 IP 地址之间的对应关系，例如云解析 DNS。</td></tr><tr><td align="left">本地域名服务器</td><td align="left">DNS Resolver 或 Local DNS。本地域名服务器是响应来自客户端的递归请求，并最终跟踪直到获取到解析结果的 DNS 服务器。例如用户本机自动分配的 DNS、运营商 ISP 分配的 DNS、谷歌/114 公共 DNS 等</td></tr></tbody></table></div></div><blockquote><p>每个层的域名上都有自己的域名服务器，最顶层的是根域名服务器</p><p>每一级域名服务器都知道下级域名服务器的 IP 地址，以便于一级一级向下查询</p></blockquote><h2 id="记录类型"><a aria-hidden="true" tabindex="-1" href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#记录类型"><span class="icon icon-link"></span></a>记录类型</h2><p>在 DNS 系统中，最常见的资源记录方式是 Internet 类记录，该记录由包含 4 个字段的数据构成：<code>Name</code>、<code>Value</code>、<code>Type</code>、<code>TTL</code>。</p><p>其中 <code>Name</code> 和 <code>Value</code> 可以理解为一对键值对，但是其具体含义取决于 <code>Type</code> 的类型，<code>TTL</code> 记录了该条记录应当从缓存中删除的时间。</p><p>在资源记录的类型中中，最为常见且重要的类型 <code>Type</code> 主要有：</p><div class="__dumi-default-table"><div class="__dumi-default-table-content"><table><thead><tr><th align="left">类型</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">A</td><td align="left">将域名指向一个 IPv4 地址，<code>A</code> 记录用于描述目标域名到 IP 地址的映射关系，将目标域名与 <code>A</code> 记录的 <code>Name</code> 字段进行匹配，将成功匹配的记录的 Value 字段的内容（IP 地址）输出到 DNS 回应报文中。</td></tr><tr><td align="left">CNAME</td><td align="left">将域名指向另一个域名，<code>CNAME</code> 记录用于描述目的域名和别名的对应关系，如果说 <code>A</code> 记录可以将目标域名转换为对应主机的 IP 地址，那么 <code>CNAME</code> 记录则可以将一个域名（别名）转换为另一个域名，如果多条 <code>CNAME</code> 记录指向同一个域名，则可以将多个不同的域名的请求指向同一台服务器主机。并且，<code>CNAME</code> 记录通常还对应了一条 <code>A</code> 记录，用于提供被转换的域名的 IP 地址</td></tr><tr><td align="left">NS</td><td align="left">将子域名指向另一个 DNS 服务器解析，<code>NS</code> 记录用于描述目标域名到负责解析该域名的 DNS 的映射关系，根据目标域名对 <code>NS</code> 记录的 <code>Name</code> 字段进行匹配，将成功匹配的记录的 <code>Value</code> 字段（负责解析目标域名的 DNS 的 IP 地址）输出到 DNS 回应报文中</td></tr><tr><td align="left">AAAA</td><td align="left">将域名指向一个 IPv6 地址</td></tr><tr><td align="left">MX</td><td align="left">将域名指向邮件服务器地址</td></tr><tr><td align="left">SRV</td><td align="left">记录提供特定的服务的服务器</td></tr><tr><td align="left">TXT</td><td align="left">文本长度限制 512，通常做 SDF 记录（反垃圾邮件）</td></tr><tr><td align="left">CAA</td><td align="left">CA 证书颁发机构授权校验</td></tr><tr><td align="left">显性 URL</td><td align="left">将域名重定向至另一个地址</td></tr><tr><td align="left">隐形 URL</td><td align="left">与显性 URL 类似，但是会隐藏真实的目标地址</td></tr></tbody></table></div></div><h2 id="解析过程"><a aria-hidden="true" tabindex="-1" href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#解析过程"><span class="icon icon-link"></span></a>解析过程</h2><p>DNS 是一种使用 UDP 协议进行域名查询的协议，其最主要的目标就是将域名转换为 IP 地址。</p><p>DNS 查询的结果通常会在本地域名服务器中进行缓存，如果本地域名服务器中有缓存的情况下，则会跳过如下 DNS 查询步骤，很快返回解析结果。下面的示例则概述了本地域名服务器没有缓存的情况下，DNS 查询所需的 8 个步骤：</p><ol><li>用户在 Web 浏览器中输入 <code>www.taobao.com</code>， 则由本地域名服务器开始进行递归查询。</li><li>本地域名服务器采用 <strong>迭代查询</strong> 的方法，向根域名服务器进行查询 。</li><li>根域名服务器告诉本地域名服务器，下一步应该查询的顶级域名服务器 <code>.com</code> TLD 的 IP 地址</li><li>本地域名服务器向顶级域名服务器 <code>.com</code> TLD 进行查询</li><li><code>.com</code> TLD 服务器告诉本地域名服务器，下一步查询 <code>www.taobao.com</code> <strong>权威域名服务器</strong>的 IP 地址</li><li>本地域名服务器向 <code>www.taobao.com</code> 权威域名服务器发送查询</li><li><code>www.taobao.com</code> 权威域名服务器告诉本地域名服务器所查询的主机 IP 地址</li><li>本地域名服务器最后把查询的 IP 地址响应给 Web 浏览器，一旦 DNS 查询的 8 个步骤返回了 <code>www.taobao.com</code> 的 IP 地址，浏览器就能够发出对网页的请求：</li><li>浏览器向 IP 地址发出 HTTP 请求</li><li>该 IP 处的 web 服务器返回要在浏览器中呈现的网页</li></ol></div><img alt="DNS Workflow" src="/javascript-guidebook/static/workflow.bc8acb30.jpeg" width="540"/><div class="markdown"><p><strong>详细解析：</strong></p><p>以查询 <code>www.taobao.com</code> 对应的 IP 地址为例，操作系统首先会在本地尝试解析，比如使用众所周知的 <code>hosts</code> 文件，同时如果有解析缓存的话，操作系统也会去查询。如果是在浏览器中进行查询，浏览器自己有时也会有解析缓存。</p><ul><li>用户设备<ul><li>浏览器可能会缓存域名解析</li><li>用户系统中可以有自己的域名映射表</li></ul></li><li>公共域名服务器<ul><li>通常由 ISP 提供</li><li>缓存上一级域名服务器的结果</li></ul></li></ul><p>在查询没有结果时，设备最终会开始向域名服务器发起查询请求。公共域名服务器一般就是用户的 ISP 提供的。这种公共域名服务器通常会缓存查询结果，因此如果缓存命中，查询就可以到此结束。当然缓存本身是有时效的，这个时效就被称为 TTL。对于超过时效的查询结果，域名服务器有义务重新发起查询请求。但查询本身是非常消耗流量的事情，因此也有一些公共服务器不严格遵守 TTL，超时缓存。</p><p>未命名缓存的查询，公共服务器会向顶级域名服务器进行查询。以上述例子来说，因为公共域名服务器不知道 <code>taobao.com</code> 的解析权归谁，因此它会向顶级域名服务器——<code>com</code> 域名服务器发起请求，寻找 <code>taobao.com</code> 对应的域名服务器。顶级域名服务器一般是由域名经营机构来维护的，有些甚至归属国家机关管理，例如国别域名。理论上来说，在顶级域名服务器之上还有一个根域名服务器，不过在平时很难意识到它的存在。</p><ul><li>公共域名服务器<ul><li>DNS 级联的特性决定了中途可以有更多域名服务器</li></ul></li><li>顶级域名服务器<ul><li>由顶级域名经营机构维护</li><li>可细分为与国家、通用</li></ul></li></ul><p>在查找到 <code>taobao.com</code> 的域名服务器之后，就可以向域名服务器查询 <code>www.taobao.com</code> 的 IP 了。这个过程是由上到下指定下来的，所以这种域名服务器可以被称为权威域名服务器。对于开发者来说，我们自己平时在域名服务器那里购买到域名之后，录入自己域名对应的 IP，其实就是在向权威域名服务器录入信息。一些大型企业会自己维护权威域名服务器，这样既可以抵御一些针对性的攻击，同时也可以更好地优化解析的速度。</p><ul><li>公共域名服务器</li><li>权威域名服务器<ul><li>通常由专业的域名服务机构提供</li><li>购买域名时一般会提供</li></ul></li></ul><h2 id="排查与优化"><a aria-hidden="true" tabindex="-1" href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#排查与优化"><span class="icon icon-link"></span></a>排查与优化</h2><h3 id="常见问题"><a aria-hidden="true" tabindex="-1" href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#常见问题"><span class="icon icon-link"></span></a>常见问题</h3><ul><li>DNS 服务器本身有问题，响应慢并且不稳定</li><li>或者是，客户端到 DNS 服务器的网络延迟比较大</li><li>再或者，DNS 请求或者响应包，在某些情况下被链路中的网络设备弄丢了</li></ul><h3 id="故障排查顺序"><a aria-hidden="true" tabindex="-1" href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#故障排查顺序"><span class="icon icon-link"></span></a>故障排查顺序</h3><ol><li>检查本地 <code>hosts</code>：<code>cat /etc/hosts</code></li><li>检查 <code>resolv.conf</code> 文件：<code>cat /etc/resolv.conf</code>。在 <code>Redhat7 / Centos7</code> 上修改 <code>resolv.conf</code> 里的 DNS 地址后，重启启网络服务发现 DNS 地址消失了，那么检查下网卡配置文件。</li><li>检查网卡配置文件：<code>cat /etc/sysconfig/network-scripts/ifcfg-&lt;网卡名称&gt;</code>，看下里头有没 DNS 配置信息，没有的话补上去。</li></ol><h3 id="常见优化技术"><a aria-hidden="true" tabindex="-1" href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#常见优化技术"><span class="icon icon-link"></span></a>常见优化技术</h3><ol><li>HttpDNS：客户端基于 HTTP 协议，向 CDN 服务商指定的 DNS 服务器发送域名解析请求，从而避免 LocalDNS 造成的域名劫持和跨网访问</li><li>Http 302 跳转：CDN 厂商维护 CDN 域名 IP 库，根据用户访问终端的 IP 和 CDN 边缘节点的状态，选择最合适的 CDN 节点，发出 HTTP 的 302 返回码，将用户的请求跳转到合适的 CDN 边缘节点。</li></ol><h3 id="常见优化方法"><a aria-hidden="true" tabindex="-1" href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#常见优化方法"><span class="icon icon-link"></span></a>常见优化方法</h3><ul><li>缓存：缓存是最有效的方法，但要注意，一旦缓存过期，还是要去 DNS 服务器重新获取新记录。不过，这对大部分应用程序来说都是可接受的。</li><li>预解析：这是浏览器等 Web 应用中最常用的方法，也就是说，不等用户点击页面上的超链接，浏览器就会在后台自动解析域名，并把结果缓存起来。</li><li>HTTPDNS：使用 HTTPDNS 取代常规的 DNS 解析。这是很多移动应用会选择的方法，特别是如今域名劫持普遍存在，使用 HTTP 协议绕过链路中的 DNS 服务器，就可以避免域名劫持的问题。</li><li>全局负载均衡：基于 DNS 的全局负载均衡（GSLB）。这不仅为服务提供了负载均衡和高可用的功能，还可以根据用户的位置，返回距离最近的 IP 地址。</li><li>对于移动客户端，在 APP 启动时对需要解析的域名做预先解析，然后把解析的结果缓存到本地的一个 LRU 缓存里面。这样当我们要使用这个域名的时候，只需要从缓存中直接拿到所需要的 IP 地址就好了，如果缓存中不存在才会走整个 DNS 查询的过程。同时为了避免 DNS 解析结果的变更造成缓存内数据失效，我们可以启动一个定时器定期地更新缓存中的数据。</li></ul><h3 id="dns-污染解决方案"><a aria-hidden="true" tabindex="-1" href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#dns-污染解决方案"><span class="icon icon-link"></span></a>DNS 污染解决方案</h3><p>一般是考虑尽可能自主控制 DNS 解析，比如使用专用 DNS 服务器，HTTPDNS，甚至是直接使用 IP 地址跳过解析</p><h2 id="dns-术语"><a aria-hidden="true" tabindex="-1" href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#dns-术语"><span class="icon icon-link"></span></a>DNS 术语</h2><p><strong>DNS 缓存</strong></p><p>DNS 缓存是将解析数据存储在靠近发起请求的客户端的位置，也可以说 DNS 数据是可以缓存在任意位置，最终目的是以此减少递归查询过程，可以更快的让用户获得请求结果。</p><p><strong>TTL</strong></p><p>英文全称 Time To Live ，这个值是告诉本地域名服务器，域名解析结果可缓存的最长时间，缓存时间到期后本地域名服务器则会删除该解析记录的数据，删除之后，如有用户请求域名，则会重新进行递归查询/迭代查询的过程。</p><p><strong>DNS Query Flood Attack</strong></p><p>指域名查询攻击，攻击方法是通过操纵大量傀儡机器，发送海量的域名查询请求，当每秒域名查询请求次数超过 DNS 服务器可承载的能力时，则会造成解析域名超时从而直接影响业务的可用性。</p><p><strong>URL 转发</strong></p><p>英文 Url Forwarding，也可称地址转向，它是通过服务器的特殊设置，将一个域名指向到另外一个已存在的站点</p><p><strong>DNSSEC</strong></p><p>域名系统安全扩展（DNS Security Extensions），简称 DNSSEC。它是通过数字签名来保证 DNS 应答报文的真实性和完整性，可有效防止 DNS 欺骗和缓存污染等攻击，能够保护用户不被重定向到非预期地址，从而提高用户对互联网的信任。</p><h2 id="常用-dns"><a aria-hidden="true" tabindex="-1" href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#常用-dns"><span class="icon icon-link"></span></a>常用 DNS</h2><ul><li>114 DNS：<code>114.114.114.114</code> 或 <code>114.114.115.115</code></li><li>阿里 DNS：<code>223.5.5.5</code> 或 <code>223.6.6.6</code></li><li>百度 DNS：<code>180.76.76.76</code></li><li>DNS 派：<ul><li>电信 <code>101.226.4.6</code></li><li>联通 <code>123.125.81.6</code></li><li>移动 <code>101.226.4.6</code></li><li>铁通 <code>101.226.4.6</code></li></ul></li><li>OneDNS<ul><li>南方 <code>112.124.47.27</code></li><li>北方 <code>114.215.126.16</code></li><li>共用 <code>42.236.82.22</code></li></ul></li><li>Google DNS：<code>8.8.8.8</code> 或 <code>8.8.4.4</code></li><li>OpenDNS：<code>208.67.222.222</code> 或 <code>208.67.220.220</code></li><li>360 DNS：<code>101.226.4.6</code> 或 <code>123.125.81.6</code></li></ul><h2 id="参考资料"><a aria-hidden="true" tabindex="-1" href="/javascript-guidebook//computer-networks/computer-network-architecture/dns#参考资料"><span class="icon icon-link"></span></a>参考资料</h2><ul><li><a target="_blank" rel="noopener noreferrer" href="https://blog.csdn.net/baidu_37964071/article/details/80500825">DNS（域名解析协议）详解<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://www.tuicool.com/articles/V7JN32Z">从输入 URL 到页面加载完成的过程中都发生了什么<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://www.cnblogs.com/coco1s/p/5365179.html">前端性能：浅谈域名发散与域名收敛<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://segmentfault.com/a/1190000004641599">域名收敛：前端优化<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://www.cnblogs.com/zhangchengye/p/5368398.html">DNS 解析过程与域名收敛、域名发散、SPDY 应用<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://help.aliyun.com/knowledge_detail/39834.html">解析生效测试方法<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/amandakelake/blog/issues/50">【性能优化】DNS 预解析<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/javascript-guidebook/edit/master/docs/computer-networks/computer-network-architecture/dns.md">Edit this doc on GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="Last update: ">2/21/2022 13:47:53</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/javascript-guidebook/umi.6cde7df5.js"></script>
  </body>
</html>
