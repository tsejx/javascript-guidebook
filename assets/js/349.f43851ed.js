(window.webpackJsonp=window.webpackJsonp||[]).push([[349],{418:function(t,a,s){"use strict";s.r(a);var n=s(0),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"weakmap"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#weakmap"}},[t._v("#")]),t._v(" WeakMap")]),t._v(" "),s("p",[t._v("WeakMap å¯¹è±¡æ˜¯ä¸€ç»„é”®/å€¼å¯¹çš„é›†åˆï¼Œå…¶ä¸­çš„é”®æ˜¯"),s("strong",[t._v("å¼±å¼•ç”¨")]),t._v("çš„ã€‚å…¶é”®å¿…é¡»æ˜¯"),s("strong",[t._v("å¯¹è±¡")]),t._v("ï¼Œè€Œå€¼å¯ä»¥æ˜¯ä»»æ„çš„ã€‚")]),t._v(" "),s("h2",{attrs:{id:"è¯­æ³•"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#è¯­æ³•"}},[t._v("#")]),t._v(" è¯­æ³•")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WeakMap")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("iterable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("å‚æ•° "),s("code",[t._v("iterable")]),t._v(" æ˜¯ä¸€ä¸ªæ•°ç»„æˆ–è€…å…¶ä»–å¯è¿­ä»£çš„ä¸”å…ƒç´ æ˜¯é”®å€¼å¯¹çš„å¯¹è±¡ã€‚æ¯ä¸ªé”®å€¼å¯¹ä¼šè¢«åŠ åˆ°æ–°çš„ WeakMap é‡Œã€‚"),s("code",[t._v("null")]),t._v(" ä¼šè¢«å½“åš "),s("code",[t._v("undefiend")]),t._v("ã€‚")]),t._v(" "),s("h2",{attrs:{id:"ç‰¹å¾"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç‰¹å¾"}},[t._v("#")]),t._v(" ç‰¹å¾")]),t._v(" "),s("h3",{attrs:{id:"å¯¹è±¡é”®å"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¯¹è±¡é”®å"}},[t._v("#")]),t._v(" å¯¹è±¡é”®å")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" map "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WeakMap")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmap"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// TypeError: Invalid value used as weak map key")]),t._v("\n\nmap"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// TypeError: Invalid value used as weak map key")]),t._v("\n")])])]),s("h3",{attrs:{id:"å¼±å¼•ç”¨å¯¹è±¡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¼±å¼•ç”¨å¯¹è±¡"}},[t._v("#")]),t._v(" å¼±å¼•ç”¨å¯¹è±¡")]),t._v(" "),s("blockquote",[s("p",[t._v('WeakMaps hold "weak" references to key objects')])]),t._v(" "),s("p",[t._v("ç¿»è¯‘è¿‡æ¥åº”è¯¥æ˜¯ "),s("strong",[t._v("WeakMap ä¿æŒäº†å¯¹é”®åæ‰€å¼•ç”¨çš„å¯¹è±¡çš„å¼±å¼•ç”¨")]),t._v("ã€‚")]),t._v(" "),s("p",[t._v("è¿™ä¸ªå¼±å¼•ç”¨çš„ç‰¹æ€§ï¼Œå°±æ˜¯ WeakMap ä¿æŒäº†å¯¹é”®åæ‰€å¼•ç”¨çš„å¯¹è±¡çš„å¼±å¼•ç”¨ï¼Œå³ "),s("router-link",{attrs:{to:"/core-modules/executable-code-and-execution-contexts/memory-management/garbage-collection.html"}},[t._v("åƒåœ¾å›æ”¶æœºåˆ¶")]),t._v(" ä¸å°†è¯¥å¼•ç”¨è€ƒè™‘åœ¨å†…ã€‚åªè¦æ‰€å¼•ç”¨çš„å¯¹è±¡çš„å…¶ä»–å¼•ç”¨éƒ½è¢«æ¸…é™¤ï¼Œåƒåœ¾å›æ”¶æœºåˆ¶å°±ä¼šé‡Šæ”¾è¯¥å¯¹è±¡æ‰€å ç”¨çš„å†…å­˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦ä¸å†éœ€è¦ï¼ŒWeakMap é‡Œé¢çš„é”®åå¯¹è±¡å’Œæ‰€å¯¹åº”çš„é”®å€¼å¯¹ä¼šè‡ªåŠ¨æ¶ˆå¤±ï¼Œä¸ç”¨æ‰‹åŠ¨åˆ é™¤å¼•ç”¨ã€‚")],1),t._v(" "),s("p",[t._v("ä¹Ÿæ­£æ˜¯å› ä¸ºè¿™æ ·çš„ç‰¹æ€§ï¼ŒWeakMap å†…éƒ¨æœ‰å¤šå°‘ä¸ªæˆå‘˜ï¼Œå–å†³äºåƒåœ¾å›æ”¶æœºåˆ¶æœ‰æ²¡æœ‰è¿è¡Œï¼Œè¿è¡Œå‰åå¾ˆå¯èƒ½æˆå‘˜ä¸ªæ•°æ˜¯ä¸ä¸€æ ·çš„ï¼Œè€Œåƒåœ¾å›æ”¶æœºåˆ¶ä½•æ—¶è¿è¡Œæ˜¯ä¸å¯é¢„æµ‹çš„ï¼Œå› æ­¤ ES6 è§„å®š WeakMap ä¸å¯éå†ã€‚")]),t._v(" "),s("p",[t._v("æ‰€ä»¥ WeakMap ä¸åƒ Mapï¼Œä¸€æ˜¯æ²¡æœ‰éå†æ“ä½œï¼ˆå³æ²¡æœ‰ "),s("code",[t._v("keys()")]),t._v("ã€"),s("code",[t._v("values()")]),t._v(" å’Œ "),s("code",[t._v("entries()")]),t._v(" æ–¹æ³•ï¼‰ï¼Œä¹Ÿæ²¡æœ‰ "),s("code",[t._v("size")]),t._v(" å±æ€§ï¼Œä¹Ÿä¸æ”¯æŒ "),s("code",[t._v("clear")]),t._v(" æ–¹æ³•ï¼Œæ‰€ä»¥ WeakMap åªæœ‰å››ä¸ªæ–¹æ³•å¯ç”¨ï¼š"),s("code",[t._v("get()")]),t._v("ã€"),s("code",[t._v("set()")]),t._v("ã€"),s("code",[t._v("has()")]),t._v("ã€"),s("code",[t._v("delete()")]),t._v("ã€‚")]),t._v(" "),s("p",[t._v("ç‰¹å¾è¯¦ç»†åˆ†æè¯·å‚é˜… "),s("a",{attrs:{href:"https://juejin.im/post/5b594512f265da0f6263840f",target:"_blank",rel:"noopener noreferrer"}},[t._v("ğŸ“ ES6 ç³»åˆ—ä¹‹ WeakMap"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"å®ä¾‹æ–¹æ³•"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å®ä¾‹æ–¹æ³•"}},[t._v("#")]),t._v(" å®ä¾‹æ–¹æ³•")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("æ–¹æ³•")]),t._v(" "),s("th",[t._v("è¯´æ˜")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v("WeakMap.prototype.delete(key)")])]),t._v(" "),s("td",[t._v("ç§»é™¤ "),s("code",[t._v("key")]),t._v(" çš„å…³è”å¯¹è±¡")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("WeakMap.prototype.get(key)")])]),t._v(" "),s("td",[t._v("è¿”å› "),s("code",[t._v("key")]),t._v(" çš„å…³è”å¯¹è±¡æˆ– "),s("code",[t._v("undefined")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("WeakMap.prototype.has(key)")])]),t._v(" "),s("td",[t._v("åˆ¤å®šæ˜¯å¦æœ‰æŒ‡å®š "),s("code",[t._v("key")]),t._v(" å…³è”å¯¹è±¡çˆ±å“ªä¸ª")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("WeakMap.prototype.set(key)")])]),t._v(" "),s("td",[t._v("è®¾ç½®ä¸€ç»„ "),s("code",[t._v("key")]),t._v(" å…³è”å¯¹è±¡")])])])]),t._v(" "),s("h2",{attrs:{id:"ä½¿ç”¨ç¤ºä¾‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä½¿ç”¨ç¤ºä¾‹"}},[t._v("#")]),t._v(" ä½¿ç”¨ç¤ºä¾‹")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" x "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WeakMap")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" y "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WeakMap")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" a "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("b")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" c "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'BINGO!'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\ny"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ny"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ny"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" y"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 'BINGO!'")]),t._v("\n\ny"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// undefined")]),t._v("\ny"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// undefined")]),t._v("\n\nx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("has")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// true")]),t._v("\n\ny"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("has")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// false")]),t._v("\ny"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("has")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// true")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// delete()")]),t._v("\nx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("has")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// true")]),t._v("\nx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("delete")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("has")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// false")]),t._v("\n")])])]),s("hr"),t._v(" "),s("p",[s("strong",[t._v("å‚è€ƒèµ„æ–™ï¼š")])]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://juejin.im/post/5b594512f265da0f6263840f",target:"_blank",rel:"noopener noreferrer"}},[t._v("ğŸ“ ES6 ç³»åˆ—ä¹‹ WeakMap"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=e.exports}}]);